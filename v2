-- =========================================================================
--  Lógica do cliente
--  Este script cuida da GUI e envia requisições ao servidor
-- =========================================================================

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local player = Players.LocalPlayer

local TeleportRequest = ReplicatedStorage:WaitForChild("TeleportRequest")
local LootRequest = ReplicatedStorage:WaitForChild("LootRequest")

local character = player.Character or player.CharacterAdded:Wait()

local bosses = {
    "Farmer", "Cyber", "Turles", "Boku Black", "Ajax", "Yeti King", "Droid 13",
    "Nash Ketchup", "Pizza Man", "Resurrected Nappu", "Super Pikkon", "Droid 21",
    "Demon 21", "Maid 21", "Skull Alien", "Azura", "Armored Mayor", "Kataba", "Zuto"
}

local autoLootEnabled = false
local autoBossEnabled = false
local lootThread = nil
local bossThread = nil

-- Função de loop para o Auto Boss
local function startBossLoop()
    while autoBossEnabled do
        local foundBoss = false
        for _, bossName in ipairs(bosses) do
            local bossModel = workspace:FindFirstChild(bossName)
            if bossModel then
                TeleportRequest:FireServer(bossName)
                foundBoss = true
                break
            end
        end
        if not foundBoss then
            print("Nenhum boss encontrado. Esperando...")
        end
        task.wait(5)
    end
end

-- Função para lootar todos os baús automaticamente
local function startLootLoop()
    while autoLootEnabled do
        local chests = {}
        for _, v in pairs(workspace:GetDescendants()) do
            if v and v.Name:find("Chest") and (v:IsA("Part") or v:IsA("Model")) then
                table.insert(chests, v)
            end
        end
        if #chests > 0 then
            print("Iniciando loot de " .. #chests .. " baús.")
            for _, chest in pairs(chests) do
                if not autoLootEnabled then break end
                if chest and chest.Parent then
                    LootRequest:FireServer(chest)
                    task.wait(1.5)
                end
            end
            print("Loot concluído. Aguardando novos baús.")
        else
            print("Nenhum baú encontrado. Aguardando...")
        end
        task.wait(5)
    end
end

-- GUI e Eventos (o mesmo código que você já tinha, mas agora com as chamadas corretas)
local screenGui = player:WaitForChild("PlayerGui"):FindFirstChild("CustomTeleportGUI")
if not screenGui then
    screenGui = Instance.new("ScreenGui")
    screenGui.Name = "CustomTeleportGUI"
    screenGui.Parent = player:WaitForChild("PlayerGui")
end

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 200, 0, 200)
mainFrame.Position = UDim2.new(0.5, -100, 0.5, -100)
mainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
mainFrame.BorderSizePixel = 0
mainFrame.Draggable = true
mainFrame.Parent = screenGui

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 30)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextScaled = true
title.Text = "Dragon Soul - HACK"
title.Parent = mainFrame

local lootToggle = Instance.new("TextButton")
lootToggle.Size = UDim2.new(1, -20, 0, 30)
lootToggle.Position = UDim2.new(0, 10, 0, 40)
lootToggle.Text = "Auto Loot: OFF"
lootToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
lootToggle.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
lootToggle.Parent = mainFrame

local bossToggle = Instance.new("TextButton")
bossToggle.Size = UDim2.new(1, -20, 0, 30)
bossToggle.Position = UDim2.new(0, 10, 0, 80)
bossToggle.Text = "Auto Boss: OFF"
bossToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
bossToggle.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
bossToggle.Parent = mainFrame

local statusLabel = Instance.new("TextLabel")
statusLabel.Size = UDim2.new(1, -20, 0, 20)
statusLabel.Position = UDim2.new(0, 10, 0, 120)
statusLabel.Text = "Status: Parado"
statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
statusLabel.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
statusLabel.Parent = mainFrame

local teleportButton = Instance.new("TextButton")
teleportButton.Size = UDim2.new(1, -20, 0, 30)
teleportButton.Position = UDim2.new(0, 10, 0, 150)
teleportButton.Text = "Teleporte Boss (Aleatório)"
teleportButton.TextColor3 = Color3.fromRGB(255, 255, 255)
teleportButton.BackgroundColor3 = Color3.fromRGB(50, 150, 200)
teleportButton.Parent = mainFrame

lootToggle.MouseButton1Click:Connect(function()
    autoLootEnabled = not autoLootEnabled
    if autoLootEnabled then
        if autoBossEnabled then
            autoBossEnabled = false
            bossToggle.Text = "Auto Boss: OFF"
            bossToggle.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
            if bossThread and coroutine.status(bossThread) ~= "dead" then task.cancel(bossThread) end
        end
        lootToggle.Text = "Auto Loot: ON"
        lootToggle.BackgroundColor3 = Color3.fromRGB(50, 200, 50)
        statusLabel.Text = "Status: Auto Loot Ativo"
        lootThread = task.spawn(startLootLoop)
    else
        lootToggle.Text = "Auto Loot: OFF"
        lootToggle.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
        statusLabel.Text = "Status: Parado"
        if lootThread and coroutine.status(lootThread) ~= "dead" then task.cancel(lootThread) end
    end
end)

bossToggle.MouseButton1Click:Connect(function()
    autoBossEnabled = not autoBossEnabled
    if autoBossEnabled then
        if autoLootEnabled then
            autoLootEnabled = false
            lootToggle.Text = "Auto Loot: OFF"
            lootToggle.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
            if lootThread and coroutine.status(lootThread) ~= "dead" then task.cancel(lootThread) end
        end
        bossToggle.Text = "Auto Boss: ON"
        bossToggle.BackgroundColor3 = Color3.fromRGB(50, 200, 50)
        statusLabel.Text = "Status: Auto Boss Ativo"
        bossThread = task.spawn(startBossLoop)
    else
        bossToggle.Text = "Auto Boss: OFF"
        bossToggle.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
        statusLabel.Text = "Status: Parado"
        if bossThread and coroutine.status(bossThread) ~= "dead" then task.cancel(bossThread) end
    end
end)

teleportButton.MouseButton1Click:Connect(function()
    local randomIndex = math.random(1, #bosses)
    TeleportRequest:FireServer(bosses[randomIndex])
end)
